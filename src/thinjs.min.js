/* 
 * ThinJS是一个极致、快速、简便的响应式JavaScript开发框架
 * @author 吴锐涛(Joytou Wu) <1540294142@qq.com>
 * @version 1.0.0
 * @copyright 2020 吴锐涛(Joytou Wu)
 * @license Apache-2.0
 */

"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();!function(window,undefined){function thinjs_template(elements,templates,data){elements.forEach(function(element,index){var parse=eval(thinjs_compile(templates[index]));element.innerHTML=parse(data)})}function thinjs_compile(e){var t=/<%=(.+?)%>/g,n=/<%([\s\S]+?)%>/g;return e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/apos;/g,"'").replace(/nbsp;/g," "),e=e.replace(t,"`); \n  echo( $1 ); \n  echo(`").replace(n,"`); \n $1 \n  echo(`"),'\n        (function parse(data){\n            var output = "";\n            function echo(html){\n            output += html;\n            }\n            '+(e="echo(`"+e+"`);")+"\n            return output;\n        })\n    "}function thinjs_getStyle(e){for(var t={},n=e.currentStyle?e.currentStyle:getComputedStyle(e),s=Object.keys(n),r=0,i=s.length;r<i;r++)isNaN(parseInt(s[r]))&&(t[thinjs_css_obj2str(s[r].toString())]=n[s[r]]);return t}function thinjs_setStyle(e,t,n){e.style[thinjs_css_str2obj(t.toString())]=n}function thinjs_css_str2obj(e){return e.replace(/-([a-z])/g,function(e){return e.toUpperCase().replace("-","")})}function thinjs_css_obj2str(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function thinjs_createxmlHttpRequest(){return window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest?new XMLHttpRequest:void 0}function thinjs_convertData(e){if("object"===(void 0===e?"undefined":_typeof(e))){var t="";for(var n in e)t+=n+"="+e[n]+"&";return t=t.substring(0,t.length-1)}return e}function thinjs_parseString(e){var t="";if(e instanceof Array){t+="[";for(var n=0;n<e.length;n++)"object"===_typeof(e[n])?t+=thinjs_parseString(e[n]):t+="string"==typeof e[n]?'"'+e[n]+'"':e[n],n+1<e.length&&(t+=", ");t+="]"}else if(e instanceof Object){t+="{";for(var n=0,s=Object.keys(e),r=Object.values(e);n<r.length;n++)"object"===_typeof(r[n])?t+=s[n]+": "+thinjs_parseString(r[n]):t+=s[n]+": "+("string"==typeof r[n]?'"'+r[n]+'"':r[n]),n+1<r.length&&(t+=", ");t+="}"}else t+="string"==typeof e?'"'+e+'"':e;return t}var VERSION="1.0.0",moduleMap={},ThinJS=function(){function e(t,n){var s=this;if(_classCallCheck(this,e),t=t||document,this.elements=[],this.events={},Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1}),"string"==typeof t)if(document.querySelectorAll)for(var r=document.querySelectorAll(t),i=0,a=r.length;i<a;i++)r[i].tagName!==undefined&&this.elements.push(r[i]);else e.error("ThinJS: This browser does not support function querySelectorAll.");else if("object"===(void 0===t?"undefined":_typeof(t)))if(t instanceof Array)this.elememts=t;else if(t instanceof HTMLElement)this.elements.push(t);else if(t instanceof NodeList)for(var i=0,a=node_list.length;i<a;i++)t[i].tagName!==undefined&&this.elements.push(t[i]);else if(t instanceof HTMLDocument||t instanceof Window)this.elements.push(t);else if(t instanceof Object)for(var i=0,a=node_list.length;i<a;i++)t[i].tagName!==undefined&&this.elements.push(t[i]);else e.error("ThinJS: Unknown type of elements.");else e.error("ThinJS: Unknown type of elements.");if(n){var l=[];this.elements.forEach(function(e){l.push(e.innerHTML)}),this.datas=n,this.datas=new Proxy(this.datas,{get:function(e,t,n){return e[t]},set:function(e,t,n,r){e[t]=n,thinjs_template(s.elements,l,s.datas)}}),thinjs_template(this.elements,l,this.datas)}for(var o in moduleMap)this.__proto__[o]=moduleMap[o];return this}return _createClass(e,[{key:"define",value:function(e,t){moduleMap[e]=t}},{key:"ready",value:function(e){var t=this.elements[0],n=e,s=!(!window.attachEvent||window.opera),r=/webkit\/(\d+)/i.test(navigator.userAgent)&&RegExp.$1<525,i=[],a=function(){for(var e=0;e<i.length;e++)i[e]()};if(!s&&!r&&t.addEventListener)return t.addEventListener("DOMContentLoaded",n,!1);if(!(i.push(n)>1))if(s)!function(){try{t.documentElement.doScroll("left"),a()}catch(e){setTimeout(arguments.callee,0)}}();else if(r)var l=setInterval(function(){/^(loaded|complete)$/.test(t.readyState)&&(clearInterval(l),a())},0)}},{key:"eq",value:function(e){return this.elements=[this.elements[parseInt(e)]]||[],this}},{key:"not",value:function(e){return this.elements=this.elements.filter(function(t){return!t.matches(e)}),this}},{key:"filter",value:function(e){return this.elements=this.elements.filter(function(t){return t.matches(e)}),this}},{key:"html",value:function(){if(arguments[0]===undefined){if(this.elements.length>1){var e=[];return this.elements.forEach(function(t){e.push(t.innerHTML)}),e}return 1===this.elements.length?this.elements[0].innerHTML:""}var t=arguments;return this.elements.forEach(function(e){e.innerHTML=t[0]}),this}},{key:"text",value:function(){if(arguments[0]===undefined){if(this.elements.length>1){var e=[];return this.elements.forEach(function(t){e.push(t.innerTEXT)}),e}return 1===this.elements.length?this.elements[0].innerTEXT:""}var t=arguments;return this.elements.forEach(function(e){e.innerTEXT=t[0]}),this}},{key:"before",value:function(t){return t||e.error("function before(): Paras should not empty."),this.elements.forEach(function(e){e.innerHTML=t+e.innerHTML}),this}},{key:"after",value:function(t){return t||e.error("function after(): Paras should not empty."),this.elements.forEach(function(e){e.innerHTML=e.innerHTML+t}),this}},{key:"empty",value:function(){return this.elements.forEach(function(e){e.innerHTML="",e.hasAttribute("input")&&e.setAttribute("input","")}),this}},{key:"isEmpty",value:function(){if(0===this.elements.length)return!0;if(1===this.elements.length){return!(this.elements[0].innerHTML||this.elements[0].innerTEXT||this.elements[0].childNodes.length)}var e=[];return this.elements.forEach(function(t){var n=!(t.innerHTML||t.innerTEXT||t.childNodes.length);e.push(n)}),e}},{key:"each",value:function(e){return this.elements.forEach(e),this}},{key:"foreach",value:function(e){return this.elements.forEach(e),this}},{key:"forEach",value:function(e){return this.elements.forEach(e),this}},{key:"siblings",value:function(){for(var e=[],t=this.elements[0].parentNode.firstChild;t=t.nextSibling;)1===t.nodeType&&(this.elements.includes(t)||(arguments[0]&&t.matches(arguments[0])||!arguments[0])&&e.push(t));return this.elements=e,this}},{key:"on",value:function(){var t=this.events,n=arguments;(n.length<2||n.length>3)&&e.error("function on(): The num of paras should be 2 or 3.");var s=this.elements,r=n[0],i=n[n.length-1];return r=r.replace(/^[\s]*(.*?)[\s]*$/g,"$1"),r=r.split(" "),r.forEach(function(e){t[e]?t[e].push(i):(t[e]=[],t[e].push(i),s.forEach(function(s){s.addEventListener?s.addEventListener(e,function(s){var r=s||window.event;if(3===n.length){var i=n[1];if((r.target||r.srcElement).matches(i))for(var a=0,l=t[e].length;a<l;a++)t[e][a](r)}else for(var a=0,l=t[e].length;a<l;a++)t[e][a](r)}):s.attachEvent("on"+e,function(s){var r=s||window.event;if(3===n.length){var i=n[1];if((r.target||r.srcElement).matches(i))for(var a=0,l=t[e].length;a<l;a++)t[e][a](r)}else for(var a=0,l=t[e].length;a<l;a++)t[e][a](r)})}))}),this}},{key:"off",value:function(){var t=arguments;switch(t.length){case 0:Object.keys(this.events).forEach(function(e){this.events[e].length=0}),this.events={};break;case 1:this.events[t[0]]&&(this.events[t[0]].length=0);break;case 2:if(this.events[t[0]])for(var n=0,s=this.events[t[0]].length;n<s;n++)if(this.events[t[0]][n]===t[1]){this.events[t[0]].splice(n,1);break}break;default:e.error("function off(): The num of patas should be less than 3.")}return this}},{key:"contains",value:function(t){if(t||e.error("function contains(): Paras should not be empty."),"string"==typeof t){var n=!1;return this.elements.forEach(function(e){e.matches(t)&&(n=!0)}),n}return this.elements.includes(t.elements[0])}},{key:"slice",value:function(){var t;arguments[0]||e.error("function slice(): Paras should not empty.");var n=this.elements;return this.elements=(t=Array.prototype.slice).call.apply(t,[n].concat(Array.prototype.slice.call(arguments))),this}},{key:"addClass",value:function(t){t||e.error("function addClass(): Paras should not empty.");for(var n=0,s=this.elements.length;n<s;n++){var r=this.elements[n].attributes.getNamedItem("class");if(r){var i=r.textContent;i=i.trim(),i=i.replace(/\s+/g," ");var a=i.split(" ");i="",a.includes(t)||a.push(t),this.elements[n].getAttributeNode("class").value=a.join(" ")}else{var l=document.createAttribute("class");l.nodeValue=t,this.elements[n].attributes.setNamedItem(l)}}return this}},{key:"removeClass",value:function(t){t||e.error("function removeClass(): Paras should not empty.");for(var n=0,s=this.elements.length;n<s;n++){var r=this.elements[n].attributes.getNamedItem("class");if(r){var i=r.textContent;i=i.trim(),i=i.replace(/\s+/g," ");var a=i.split(" ");i=t,a=a.filter(function(e){return e!==i}),this.elements[n].getAttributeNode("class").value=a.join(" ")}}return this}},{key:"hasClass",value:function(e){if(1===this.elements.length){var t=this.elements[0].attributes.getNamedItem("class");if(t){var n=t.textContent;t=null,n=n.trim(),n=n.replace(/\s+/g," ");var s=n.split(" ");return n="",e?s.includes(e):!!s.length}return!1}for(var r=[],i=0,a=this.elements.length;i<a;i++){var t=this.elements[i].attributes.getNamedItem("class");if(t){var n=t.textContent;t=null,n=n.trim(),n=n.replace(/\s+/g," ");var s=n.split(" ");n="",e?r.push(s.includes(e)):r.push(!!s.length)}else r.push(!1)}return r}},{key:"toggleClass",value:function(e){return this.hasClass(e)?this.removeClass(e):this.addClass(e),this}},{key:"class",value:function(){switch(arguments.length){case 0:if(1===this.elements.length){var t=this.elements[0].getAttributeNode("class");return t?t.value:""}if(this.elements.length>1){for(var n=[],s=0,r=this.elements.length;s<r;s++){var t=this.elements[s].getAttributeNode("class");t?n.push(t.value):n.push("")}return n}return"";case 1:return this.addClass(arguments[0]);case 2:e.error("function class(): The num of paras should be less than or equal 1.")}return""}},{key:"style",value:function(){switch(arguments.length){case 0:if(1===this.elements.length)return thinjs_getStyle(this.elements[0]);if(this.elements.length>1){for(var t=[],n=0,s=this.elements.length;n<s;n++)t.push(thinjs_getStyle(this.elements[n]));return t}return null;case 1:if("string"==typeof arguments[0]){if(1===this.elements.length)return thinjs_getStyle(this.elememts[0])[arguments[0]];if(this.elements.length>1){for(var t=[],n=0,s=this.elements.length;n<s;n++)t.push(thinjs_getStyle(this.elememts[n])[arguments[0]]);return t}return null}if(arguments[0]instanceof Array){var r=arguments[0];if("string"==typeof r[0]){if(1===this.elements.length){for(var t={},n=0,s=r.length;n<s;n++)t[r[n]]=thinjs_getStyle(this.elements[0])[r[n]];return t}if(this.elements.length>1){for(var t=[],n=0,s=this.elements.length;n<s;n++){for(var i={},n=0,s=r.length;n<s;n++)t[r[j]]=thinjs_getStyle(this.elements[n])[r[j]];t.push(i)}return t}return null}for(var n=0,s=r.length;n<s;n++)this.elements.forEach(function(e){thinjs_setStyle(e,Object.keys(r[n])[0],Object.values(r[n])[0])});return this}for(var a=Object.keys(arguments[0]),l=Object.values(arguments[0]),n=0,s=a.length;n<s;n++)this.elements.forEach(function(e){thinjs_setStyle(e,a[n],l[n])});return this;case 2:var o=arguments;return this.elements.forEach(function(e){thinjs_setStyle(e,o[0],o[1])}),this;default:e.error("function style(): The num of paras should be less than 3.")}}},{key:"show",value:function(){return this.elements.forEach(function(e){thinjs_setStyle(e,"display","")}),this}},{key:"hide",value:function(){return this.elements.forEach(function(e){thinjs_setStyle(e,"display","none")}),this}},{key:"toggle",value:function(){return this.elements.forEach(function(e){thinjs_setStyle(e,"display","none"===thinjs_get(e).display?"":"none")}),this}},{key:"addAttr",value:function(){return arguments[0]||e.error("function addAttr(): Paras should not empty."),this.attr.apply(this,arguments),this}},{key:"removeAttr",value:function(){arguments[0]||e.error("function removeAttr(): Paras should not empty.");var t=arguments;return t[0]instanceof Array?this.elements.forEach(function(e){for(var n=0,s=t[0].length;n<s;n++)e.attributes.removeNamedItem(t[0][n])}):"string"==typeof t[0]?this.elements.forEach(function(e){e.attributes.removeNamedItem(t[0])}):e.error("function removeAttr(): The type of paras not meet the requirements."),this}},{key:"hasAttr",value:function(){arguments[0]||e.error("function hasAttr(): Paras should not empty.");var t=arguments;if("string"==typeof t[0]){if(1===this.elements.length)return!!this.elements[0].attributes.getNamedItem(arguments[0]);if(this.elements.length>1){var n=[];return this.elements.forEach(function(e){n.push(!!e.attributes.getNamedItem(t[0]))}),n}return null}if(t[0]instanceof Array){var n=[];return this.elements.forEach(function(e){for(var s={},r=0,i=t[0].length;r<i;r++)s[t[0][r]]=!!e.attributes.getNamedItem(t[0][r]);n.push(s)}),n}}},{key:"attr",value:function(){var t=arguments;switch(t.length){case 0:if(1===this.elements.length)return this.elements[0].attributes;if(this.elements.length>1){for(var n=[],s=0,r=this.elements.length;s<r;s++)n.push(this.elements[s].attributes);return n}return null;case 1:if("string"==typeof t[0]){if(1===this.elements.length)return this.elements[0].attributes.getNamedItem(t[0])?this.elements[0].attributes.getNamedItem(t[0]).textContent:undefined;if(this.elements.length>1){for(var n=[],s=0,r=this.elements.length;s<r;s++)n.push(this.elements[s].attributes.getNamedItem(t[0])?this.elements[s].attributes.getNamedItem(t[0]).textContent:undefined);return n}return null}if(t[0]instanceof Array){var i=t[0];if("string"==typeof i[0]){if(1===this.elements.length){for(var n={},s=0,r=i.length;s<r;s++)n[i[s]]=this.elements[0].attributes.getNamedItem(i[s])?this.elements[0].attributes.getNamedItem(i[s]).textContent:undefined;return n}if(this.elements.length>1){for(var n=[],s=0,r=this.elements.length;s<r;s++){for(var a={},l=0,r=i.length;l<r;l++)a[i[l]]=this.elements[s].attributes.getNamedItem(i[l])?this.elements[s].attributes.getNamedItem(i[l]).textContent:undefined;n.push(a)}return n}return null}return this.elements.forEach(function(e){for(var t=0,n=i.length;t<n;t++){var s=document.createAttribute(Object.keys(i[t])[0]);s.nodeValue=Object.values(i[t])[0],e.attributes.setNamedItem(s)}}),this}for(var o=Object.keys(arguments[0]),u=Object.values(arguments[0]),s=0,r=o.length;s<r;s++)this.elements.forEach(function(e){var t=document.createAttribute(o[s]);t.nodeValue=u[s],e.attributes.setNamedItem(t)});return this;case 2:var t=arguments;return this.elements.forEach(function(e){var n=document.createAttribute(t[0]);n.nodeValue=t[1],e.attributes.setNamedItem(n)}),this;default:e.error("function attr(): The num of paras should be less than 3.")}}},{key:"data",value:function(t,n){switch(arguments.length){case 0:if(1===this.elements.length){for(var s={},r=0,i=this.elements[0].attributes.length;r<i;r++){var a=this.elements[0].attributes[r];0===a.name.indexOf("data-")&&(s[a.name.replace("data-","")]=a.value)}return s}if(this.elements.length>1){for(var s=[],r=0,i=this.elements.length;r<i;r++){for(var l={},o=0,u=this.elements[r].attributes.length;o<u;o++){var a=this.elements[r].attributes[o];0===a.name.indexOf("data-")&&(l[a.name.replace("data-","")]=a.value)}s.push(l)}return s}return null;case 1:if("string"==typeof t){if(1===this.elements.length)return this.elements[0].attributes.getNamedItem("data-"+t)?this.elements[0].attributes.getNamedItem("data-"+t).textContent:undefined;if(this.elements.length>1)for(var s=[],r=0,i=this.elements.length;r<i;r++)s.push(this.elements[r].attributes.getNamedItem("data-"+t)?this.elements[r].attributes.getNamedItem("data-"+t).textContent:undefined)}else{if(!(t instanceof Array)){for(var h=Object.keys(t),c=Object.values(t),r=0,i=h.len;r<i;r++)for(var o=0,f=this.elements.length;o<f;o++){var m=document.createAttribute("data-"+h[r]);m.nodeValue=c[r],this.elements[o].attributes.setNamedItem(m)}return this}e.error("function data(): The type of paras not meet the requirements.")}return null;case 2:for(var r=0,i=this.elements.length;r<i;r++){var m=document.createAttribute("data-"+t);m.nodeValue=n,this.elements[r].attributes.setNamedItem(m)}return this;default:e.error("function data(): The num of paras should be less than 3.")}return this}},{key:"ajax",value:function(e){return function(){function e(t){_classCallCheck(this,e);var n={type:arguments[0].type?arguments[0].type.toUpperCase():"GET",url:arguments[0].url||"",async:!!arguments[0].async||!0,data:arguments[0].data||null,dataType:arguments[0].dataType||"text",contentType:arguments[0].contentType||"application/x-www-form-urlencoded;charset=UTF-8",timeout:parseInt(arguments[0].timeout)||0,beforeSend:arguments[0].beforeSend||function(){},success:arguments[0].success||function(){},error:arguments[0].error||function(){},username:arguments[0].username||"",password:arguments[0].password||""};n.beforeSend();var s=thinjs_createxmlHttpRequest();s.timeout=n.timeout,s.responseType=n.dataType,n.username&&n.password?s.open(n.type,n.url,n.async,n.username,n.password):s.open(n.type,n.url,n.async),s.setRequestHeader("Content-Type",n.contentType),s.send(thinjs_convertData(n.data)),s.onreadystatechange=function(){4===s.readyState&&(200===s.status?n.success(s.response):n.error())},this.ajax=s}return _createClass(e,[{key:"on",value:function(e,t){var n=this.ajax,s=e.trim();return s=s.split(" "),s.forEach(function(e){n.addEventListener(e,t)}),this}}],[{key:"main",value:function(t){var n=new e(t);return n.prototype=e.prototype,n}}]),e}().main(e)}},{key:"version",get:function(){return VERSION}},{key:"length",get:function(){return this.elements.length}}],[{key:"main",value:function(t,n){return new e(t,n)}}]),e}(),thinjs=function(e,t){return ThinJS.main(e,t)};thinjs.fn=thinjs.prototype={length:this.length},window.thinjs=thinjs}(window);